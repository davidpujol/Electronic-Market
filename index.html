<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title> Electronic market</title>
    <link href="css/main.css" rel="stylesheet" />

    <!-- Include the angularJs library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.9/angular.min.js"></script>

    <script type="text/javascript">
        //when using AngularJS you can only access global variables

        var list = [];
        var quantity = new Map();
        sessionStorage.setItem('products', JSON.stringify(list));
        sessionStorage.setItem('quantities', JSON.stringify(quantity));
        sessionStorage.number = 0;
        sessionStorage.totalAmount = 0;

    </script>

</head>



<body data-ng-app="ElectronicMarket" ng-controller="controllerProducts">

    <a href="index.html"><h1>ELECTRONIC MARKET</h1></a>
    <a href="index2.html"> <button class="buying-button"> <img class="image-carrito2" src="img/carrito-compra2.png"> Shopping car
        (<span id="number">0</span>) </button> </a>

    <section class="productsContainer">
        <h2 class="containerTitle">{{category}}: </h2>

        <div class="single-product" ng-if="category == 'OFFERS'" data-ng-repeat="product in products">
            <add-product info="product"> </add-product>
        </div>

        <div class="single-product" ng-if="category == 'COMPUTERS'" data-ng-repeat="product in computers">
            <add-product info="product"> </add-product>
        </div>

        <div class="single-product" ng-if="category == 'FANS'" data-ng-repeat="product in fans">
            <add-product info="product"> </add-product>
        </div>

        <div class="single-product" ng-if="category == 'FREEZER'" data-ng-repeat="product in freezer">
            <add-product info="product"> </add-product>
        </div>

        <div class="single-product" ng-if="category == 'FRIDGES'" data-ng-repeat="product in fridges">
            <add-product info="product"> </add-product>
        </div>

        <div class="single-product" ng-if="category == 'TV'" data-ng-repeat="product in tv">
            <add-product info="product"> </add-product>
        </div>

        <div class="single-product" ng-if="category == 'WASHING MACHINES'" data-ng-repeat="product in washingMachines">
            <add-product info="product"> </add-product>
        </div>

    </section>

    <nav>
        <div class="nav-content">
            <h3> What are you looking for...</h3>
            <ul>
                <li ng-click="category = 'OFFERS'"> Offers</li>
                <li ng-click="category = 'TV'"> Televisions</li>
                <li ng-click="category = 'WASHING MACHINES'"> Washing machines </li>
                <li ng-click="category = 'COMPUTERS'"> Computers</li>
                <li ng-click="category = 'FANS'"> Fans </li>
                <li ng-click="category = 'FRIDGES'">Fridges </li>
                <li ng-click="category = 'FREEZER'"> Freezer </li>
                <li ng-click="category = 'OTHERS'"> Others </li>
            </ul>
        </div>


    </nav>



    <section class="subscription">
        <form id="subscriptionForm">
            <h4 class="title-subscription"> DON'T MISS ANY OF OUR OFFERS: </h4>
            <p> Enter your email address to subscribe:
                <input type="email" name="subscription-email" value="Your email address" class="subscription-email" onclick="value=''" required>
                <input type="image" src="img/send-arrow.png" class="send-subscription">
            </p>

        </form>
        <br>
    </section>

    <write-footer> </write-footer>

    <script type="text/javascript">
        //we keep the old values
        if (localStorage.number > 0) {
            sessionStorage.number = localStorage.number;    //keep old number
            list = JSON.parse(localStorage.products);     //keep old list
            sessionStorage.setItem('products', JSON.stringify(list));
            sessionStorage.totalAmount = localStorage.totalAmount;

            sessionStorage.quantities = localStorage.quantities;
            //el problema esta en quantity
           // quantity = new Map(JSON.parse(sessionStorage.quantities));

            document.getElementById("number").innerHTML = sessionStorage.number;
            localStorage.number = 0;        //reinitialize values
            localStorage.products = [];
            localStorage.totalAmount = 0;
            localStorage.quantities = [];
        }

    </script>


    <!-- Include new modules -->
    <script src="app.js"> </script>

    <!-- Include new directives -->
    <script src="js/directives/addProduct.js"></script>
    <script src="js/directives/writeFooter.js"></script>

    <!-- Include new controllers -->
    <script src="js/controller/controllerProducts.js"> </script>

</body>


</html>